(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{154:function(e,t,i){},155:function(e,t,i){},156:function(e,t,i){},157:function(e,t,i){},179:function(e,t,i){"use strict";var a=i(154);i.n(a).a},180:function(e,t,i){"use strict";var a=i(155);i.n(a).a},181:function(e,t,i){"use strict";var a=i(156);i.n(a).a},182:function(e,t,i){"use strict";var a=i(157);i.n(a).a},185:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"reviews-page"},[e.isLoading?i("div",{staticClass:"reviews-page__preloader"},[i("clip-loader",{attrs:{color:e.accentColor,size:70}})],1):[i("div",{staticClass:"reviews-page__title"},[i("page-title")],1),e.isShowForm?i("div",{ref:"form",staticClass:"reviews-page__form"},[i("review-form",{attrs:{"is-sending":e.isSendingForm,"current-review":e.currentReview},on:{reset:e.cancelReviewChanges,create:e.createNewReview,update:e.updateCurrentReview}})],1):e._e(),i("div",{staticClass:"reviews-page__grid"},[i("card-gradient-button",{staticClass:"reviews-page__item",attrs:{"is-disabled":e.isShowForm&&!e.currentReview},on:{click:e.addReview}},[e._v("Добавить "),i("br"),e._v(" отзыв")]),e._l(e.reviews,function(t){return i("review-item",{key:t.id,staticClass:"reviews-page__item",attrs:{review:t,"is-active":t===e.currentReview},on:{edit:function(i){return e.editReview(t)},delete:function(i){return e.deleteReview(t.id)}}})})],2)]],2)};a._withStripped=!0;var r=i(0),s=i.n(r),n=i(1),o=i.n(n),c=i(3),u=i.n(c),v=i(7),l=i(134),d=i(129),w=i(130),p=i(159),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("card",{staticClass:"new-review"},[i("div",{staticClass:"new-review__header",attrs:{slot:"title"},slot:"title"},[e._v("Новый отзыв")]),i("template",{slot:"content"},[i("form",{staticClass:"new-review__form",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[i("div",{staticClass:"new-review__photo"},[i("avatar-upload",{attrs:{"error-message":e.validation.firstError("reviewData.photo")},model:{value:e.reviewData.photo,callback:function(t){e.$set(e.reviewData,"photo",t)},expression:"reviewData.photo"}})],1),i("div",{staticClass:"new-review__name"},[i("simple-input",{attrs:{label:"Имя автора","error-message":e.validation.firstError("reviewData.author")},model:{value:e.reviewData.author,callback:function(t){e.$set(e.reviewData,"author",t)},expression:"reviewData.author"}})],1),i("div",{staticClass:"new-review__position"},[i("simple-input",{attrs:{label:"Титул автора","error-message":e.validation.firstError("reviewData.occ")},model:{value:e.reviewData.occ,callback:function(t){e.$set(e.reviewData,"occ",t)},expression:"reviewData.occ"}})],1),i("div",{staticClass:"new-review__text"},[i("simple-textarea",{attrs:{label:"Отзыв","error-message":e.validation.firstError("reviewData.text")},model:{value:e.reviewData.text,callback:function(t){e.$set(e.reviewData,"text",t)},expression:"reviewData.text"}})],1),i("div",{staticClass:"new-review__controls"},[i("basic-button",{staticClass:"new-review__button",attrs:{size:"small",display:"flat",disabled:e.isSending},on:{click:function(t){return e.$emit("reset")}}},[e._v("Отмена")]),i("basic-button",{staticClass:"new-review__button new-review__button_save",attrs:{type:"submit",size:"small",bordered:!0,disabled:e.isSending}},[e._v("Сохранить")])],1)])])],2)};h._withStripped=!0;var _=i(51),m=i.n(_),f=i(126),b=i(125),C=i(160),g=i(120),x=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"avatar-upload"},[i("label",{staticClass:"avatar-upload__control",attrs:{for:"file-input"}},[e.renderedPhoto?i("img",{staticClass:"avatar-upload__image",attrs:{src:e.renderedPhoto}}):e._e()]),i("input",{ref:"file-input",staticClass:"avatar-upload__file",attrs:{id:"file-input",type:"file",accept:"image/jpeg,image/png"},on:{change:e.handlePhotoUpload}}),i("basic-button",{staticClass:"avatar-upload__button",attrs:{size:"small",display:"flat"},on:{click:e.uploadFile}},[e._v(e._s(e.value?"Изменить фото":"Добавить фото"))]),i("transition",{attrs:{name:"slide-up"}},[e.errorMessage?i("div",{staticClass:"avatar-upload__error"},[i("error-tooltip",[e._v(e._s(e.errorMessage))])],1):e._e()])],1)};x._withStripped=!0;var R=i(121),D=i(158),S={components:{ErrorTooltip:R.a,BasicButton:g.a},mixins:[D.a]},F=(i(179),i(6)),k=Object(F.a)(S,x,[],!1,null,"18e1ac2c",null);k.options.__file="src/admin/components/AvatarUpload.vue";var y=k.exports,$={author:"",occ:"",text:"",photo:null},j={components:{Card:f.a,SimpleInput:b.a,SimpleTextarea:C.a,BasicButton:g.a,AvatarUpload:y},props:{currentReview:{type:Object,default:null},isSending:{type:Boolean,default:!1}},watch:{currentReview:function(){this.updateReviewData(),this.validation.reset()}},mixins:[m.a.mixin],data:function(){return{reviewData:$}},validators:{"reviewData.author":function(e){return _.Validator.value(e).required("Введите автора")},"reviewData.occ":function(e){return _.Validator.value(e).required("Введите титул")},"reviewData.text":function(e){return _.Validator.value(e).required("Введите текст отзыва")},"reviewData.photo":function(e){return _.Validator.value(e).required("Загрузите фото")}},computed:{title:function(){return this.currentReview?"Редактирование отзыва":"Новый отзыв"}},methods:{updateReviewData:function(){this.reviewData=this.currentReview?u()({},this.currentReview):u()({},$)},onSubmit:function(){var e=this;this.$validate().then(function(t){if(t){var i=e.currentReview?"update":"create";e.$emit(i,e.reviewData),e.validation.reset()}})}},created:function(){this.updateReviewData()}},T=(i(180),Object(F.a)(j,h,[],!1,null,"3cb3d328",null));T.options.__file="src/admin/components/ReviewForm.vue";var O=T.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("card",{staticClass:"review-item",class:{"review-item_active":e.isActive}},[i("div",{staticClass:"review-item__header",attrs:{slot:"title"},slot:"title"},[i("img",{staticClass:"review-item__user-avatar",attrs:{src:e.imageSrc}}),i("div",{staticClass:"review-item__user-info"},[i("div",{staticClass:"review-item__user-name"},[e._v(e._s(e.review.author))]),i("div",{staticClass:"review-item__user-position"},[e._v(e._s(e.review.occ))])])]),i("template",{slot:"content"},[i("div",{staticClass:"review-item__text"},[e._v(e._s(e.review.text))]),i("div",{staticClass:"review-item__controls"},[i("button",{staticClass:"review-item__button review-item__button_edit",on:{click:function(t){return e.$emit("edit")}}},[i("div",{staticClass:"review-item__button-text"},[e._v("Править")]),i("icon",{staticClass:"review-item__button-icon_edit",attrs:{name:"pencil"}})],1),i("button",{staticClass:"review-item__button review-item__button_delete",on:{click:function(t){return e.$emit("delete")}}},[i("div",{staticClass:"review-item__button-text"},[e._v("Удалить")]),i("icon",{staticClass:"review-item__button-icon_delete",attrs:{name:"cross"}})],1)])])],2)};E._withStripped=!0;var B=i(148),L=i(50),q={components:{Card:f.a,Icon:L.a},props:{review:{type:Object,default:{}},isActive:{type:Boolean,default:!1}},data:function(){return{}},computed:{imageSrc:function(){return Object(B.a)(this.review.photo)}}},z=(i(181),Object(F.a)(q,E,[],!1,null,"0b99c53b",null));z.options.__file="src/admin/components/ReviewItem.vue";var A=z.exports,I={components:{PageTitle:w.a,CardGradientButton:p.a,ReviewForm:O,ReviewItem:A,ClipLoader:l.ClipLoader},data:function(){return{currentReview:null,isShowForm:!1,isSendingForm:!1,isLoading:!1,accentColor:d.a}},computed:u()({},Object(v.c)("reviews",{reviews:function(e){return e.reviews}})),methods:u()({},Object(v.b)("reviews",["fetchReviews","createReview","updateReview","removeReview"]),Object(v.b)("tooltips",["showTooltip"]),{createNewReview:function(){var e=o()(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isSendingForm=!0,e.prev=1,e.next=4,this.createReview(t);case 4:this.showTooltip({type:"success",text:"Отзыв успешно создан",duration:3e3}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.showTooltip({type:"error",text:e.t0.message,duration:3e3});case 10:return e.prev=10,this.isSendingForm=!1,e.finish(10);case 13:this.hideForm();case 14:case"end":return e.stop()}},e,this,[[1,7,10,13]])}));return function(t){return e.apply(this,arguments)}}(),updateCurrentReview:function(){var e=o()(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isSendingForm=!0,e.prev=1,e.next=4,this.updateReview(t);case 4:this.showTooltip({type:"success",text:"Отзыв успешно обновлен",duration:3e3}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.showTooltip({type:"error",text:e.t0.message,duration:3e3});case 10:return e.prev=10,this.isSendingForm=!1,e.finish(10);case 13:this.hideForm();case 14:case"end":return e.stop()}},e,this,[[1,7,10,13]])}));return function(t){return e.apply(this,arguments)}}(),deleteReview:function(){var e=o()(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.removeReview(t);case 3:this.showTooltip({type:"success",text:"Отзыв успешно удален",duration:3e3}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.showTooltip({type:"error",text:e.t0.message,duration:3e3});case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),showForm:function(){this.isShowForm=!0},hideForm:function(){this.isShowForm=!1,this.currentReview=null},addReview:function(){this.currentReview=null,this.showForm()},cancelReviewChanges:function(){this.currentReview=null,this.hideForm()},editReview:function(e){this.currentReview=e,this.showForm()},fetchData:function(){var e=o()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.prev=1,e.next=4,this.fetchReviews();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),this.showTooltip({type:"error",text:"Произошла ошибка при загрузке отзывов",duration:3e3});case 9:return e.prev=9,this.isLoading=!1,e.finish(9);case 12:case"end":return e.stop()}},e,this,[[1,6,9,12]])}));return function(){return e.apply(this,arguments)}}()}),created:function(){this.fetchData()}},P=(i(182),Object(F.a)(I,a,[],!1,null,"1f42caf0",null));P.options.__file="src/admin/components/pages/reviews.vue";t.default=P.exports}}]);